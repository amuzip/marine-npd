<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Marine NPD â€” SMILES to 2D Structure Viewer</title>
  <script src="https://unpkg.com/smiles-drawer@2.0.1/dist/smiles-drawer.min.js"></script>
  <style>
    /* â”€â”€â”€ Reset & Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --ocean-dark:  #0a2540;
      --ocean-mid:   #0d3b6e;
      --ocean-light: #1a5fa8;
      --teal:        #00b4d8;
      --teal-light:  #90e0ef;
      --green:       #2ec4b6;
      --surface:     #f0f6ff;
      --card-bg:     #ffffff;
      --border:      #cfe0f5;
      --text:        #1a2e45;
      --text-muted:  #5a7595;
      --badge-ulva:       #2ec4b6;
      --badge-sargassum:  #f4a261;
      --badge-gelidium:   #e76f51;
    }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: var(--surface);
      color: var(--text);
      min-height: 100vh;
    }

    /* â”€â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    header {
      background: linear-gradient(135deg, var(--ocean-dark) 0%, var(--ocean-mid) 60%, var(--ocean-light) 100%);
      color: #fff;
      padding: 28px 40px 22px;
      display: flex;
      align-items: center;
      gap: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,.35);
    }

    .header-icon {
      font-size: 2.6rem;
      line-height: 1;
      filter: drop-shadow(0 2px 6px rgba(0,0,0,.4));
    }

    .header-text h1 {
      font-size: 1.55rem;
      font-weight: 700;
      letter-spacing: .4px;
    }

    .header-text p {
      font-size: .85rem;
      color: var(--teal-light);
      margin-top: 3px;
    }

    /* â”€â”€â”€ Main layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    main {
      max-width: 1300px;
      margin: 0 auto;
      padding: 32px 24px 60px;
    }

    section + section { margin-top: 36px; }

    .section-title {
      font-size: 1.05rem;
      font-weight: 700;
      color: var(--ocean-mid);
      margin-bottom: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-title::after {
      content: '';
      flex: 1;
      height: 2px;
      background: linear-gradient(90deg, var(--border), transparent);
    }

    /* â”€â”€â”€ Input panel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .input-panel {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 22px 24px;
      box-shadow: 0 2px 12px rgba(0,100,200,.07);
    }

    .input-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 12px;
    }

    .input-row input {
      flex: 1 1 260px;
      padding: 10px 14px;
      border: 1.5px solid var(--border);
      border-radius: 8px;
      font-size: .93rem;
      color: var(--text);
      transition: border-color .2s;
    }

    .input-row input:focus {
      outline: none;
      border-color: var(--teal);
      box-shadow: 0 0 0 3px rgba(0,180,216,.12);
    }

    .input-row input::placeholder { color: #a0b8d0; }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: .9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all .2s;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--ocean-light), var(--teal));
      color: #fff;
      box-shadow: 0 2px 8px rgba(0,100,200,.25);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 14px rgba(0,100,200,.35);
    }

    .btn-secondary {
      background: var(--surface);
      color: var(--ocean-mid);
      border: 1.5px solid var(--border);
    }

    .btn-secondary:hover {
      background: var(--border);
    }

    .preset-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
    }

    .chip {
      padding: 4px 12px;
      border-radius: 20px;
      font-size: .78rem;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: all .15s;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .chip:hover { filter: brightness(1.1); transform: translateY(-1px); }

    .chip-ulva      { background: #d0f5f1; color: #1a7a72; }
    .chip-sargassum { background: #fde8d0; color: #9a4a10; }
    .chip-gelidium  { background: #fdddd6; color: #9a2510; }
    .chip-all       { background: #dce8ff; color: var(--ocean-mid); }

    /* â”€â”€â”€ Filter bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .filter-bar {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 18px;
    }

    .filter-btn {
      padding: 5px 14px;
      border-radius: 20px;
      font-size: .82rem;
      font-weight: 600;
      cursor: pointer;
      border: 2px solid transparent;
      transition: all .15s;
    }

    .filter-btn.active { border-color: currentColor; background: #fff; }

    .filter-all       { color: var(--ocean-mid);    background: #dce8ff; }
    .filter-ulva      { color: #1a7a72;              background: #d0f5f1; }
    .filter-sargassum { color: #9a4a10;              background: #fde8d0; }
    .filter-gelidium  { color: #9a2510;              background: #fdddd6; }
    .filter-custom    { color: #5a35a0;              background: #ece5ff; }

    #result-count {
      margin-left: auto;
      font-size: .82rem;
      color: var(--text-muted);
    }

    /* â”€â”€â”€ Compound grid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .compound-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(230px, 1fr));
      gap: 18px;
    }

    .compound-card {
      background: var(--card-bg);
      border: 1.5px solid var(--border);
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,60,150,.06);
      transition: all .2s;
      cursor: pointer;
      position: relative;
    }

    .compound-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 22px rgba(0,60,150,.14);
      border-color: var(--teal);
    }

    .compound-card.hidden { display: none; }

    .card-canvas-wrap {
      padding: 12px;
      background: #fafcff;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: center;
      height: 180px;
      position: relative;
    }

    .card-canvas-wrap canvas {
      max-width: 100%;
      max-height: 100%;
    }

    .error-msg {
      color: #c0392b;
      font-size: .78rem;
      text-align: center;
      padding: 8px;
    }

    .card-body {
      padding: 12px 14px 14px;
    }

    .card-title {
      font-size: .92rem;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .badge {
      display: inline-block;
      padding: 2px 9px;
      border-radius: 10px;
      font-size: .72rem;
      font-weight: 700;
      margin-bottom: 6px;
    }

    .badge-ulva      { background: #d0f5f1; color: #1a7a72; }
    .badge-sargassum { background: #fde8d0; color: #9a4a10; }
    .badge-gelidium  { background: #fdddd6; color: #9a2510; }
    .badge-custom    { background: #ece5ff; color: #5a35a0; }

    .card-smiles {
      font-family: 'Courier New', monospace;
      font-size: .68rem;
      color: var(--text-muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      margin-bottom: 6px;
    }

    .card-targets {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      margin-top: 4px;
    }

    .target-tag {
      background: #e8f0fb;
      color: var(--ocean-mid);
      border-radius: 6px;
      font-size: .68rem;
      font-weight: 600;
      padding: 2px 6px;
    }

    /* â”€â”€â”€ Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,20,60,.55);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .modal-overlay.open { display: flex; }

    .modal {
      background: #fff;
      border-radius: 18px;
      width: min(680px, 96vw);
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,.4);
      animation: slideUp .2s ease;
    }

    @keyframes slideUp {
      from { transform: translateY(30px); opacity: 0; }
      to   { transform: translateY(0);    opacity: 1; }
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 24px 16px;
      border-bottom: 1px solid var(--border);
    }

    .modal-header h2 { font-size: 1.15rem; color: var(--ocean-dark); }

    .modal-close {
      background: none;
      border: none;
      font-size: 1.4rem;
      cursor: pointer;
      color: var(--text-muted);
      line-height: 1;
      padding: 4px;
      border-radius: 6px;
    }

    .modal-close:hover { background: var(--surface); color: var(--text); }

    .modal-canvas-wrap {
      padding: 20px;
      background: #fafcff;
      border-bottom: 1px solid var(--border);
      text-align: center;
    }

    .modal-canvas-wrap canvas { max-width: 100%; }

    .modal-body {
      padding: 20px 24px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }

    .modal-field {
      display: flex;
      flex-direction: column;
      gap: 3px;
    }

    .modal-field.full { grid-column: 1 / -1; }

    .field-label {
      font-size: .75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: .5px;
      color: var(--text-muted);
    }

    .field-value {
      font-size: .88rem;
      color: var(--text);
    }

    .field-value.mono {
      font-family: 'Courier New', monospace;
      font-size: .8rem;
      background: var(--surface);
      padding: 8px 10px;
      border-radius: 6px;
      border: 1px solid var(--border);
      word-break: break-all;
    }

    .modal-actions {
      padding: 0 24px 22px;
      display: flex;
      gap: 10px;
    }

    /* â”€â”€â”€ Empty state â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-muted);
      font-size: .95rem;
    }

    .empty-state span { font-size: 2.5rem; display: block; margin-bottom: 12px; }

    /* â”€â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    footer {
      text-align: center;
      font-size: .78rem;
      color: var(--text-muted);
      padding: 24px;
      border-top: 1px solid var(--border);
    }
  </style>
</head>
<body>

<!-- â”€â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<header>
  <div class="header-icon">ğŸ§¬</div>
  <div class="header-text">
    <h1>Marine NPD â€” SMILES to 2D Structure Viewer</h1>
    <p>í•´ì–‘ ì²œì—°ë¬¼ í™”í•©ë¬¼ êµ¬ì¡° ì‹œê°í™” Â· Ulva Â· Sargassum Â· Gelidium</p>
  </div>
</header>

<main>

  <!-- â”€â”€â”€ Custom Input â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <section>
    <div class="section-title">âœï¸ ì§ì ‘ ì…ë ¥</div>
    <div class="input-panel">
      <div class="input-row">
        <input id="inp-name"   type="text"  placeholder="í™”í•©ë¬¼ ì´ë¦„ (ì˜ˆ: Fucoxanthin)" />
        <input id="inp-smiles" type="text"  placeholder="SMILES ë¬¸ìì—´ (ì˜ˆ: CC(=O)Oc1ccccc1)" />
        <select id="inp-species" style="padding:10px 12px;border:1.5px solid var(--border);border-radius:8px;font-size:.9rem;color:var(--text);background:#fff;cursor:pointer;">
          <option value="custom">Custom</option>
          <option value="ulva">Ulva</option>
          <option value="sargassum">Sargassum</option>
          <option value="gelidium">Gelidium</option>
        </select>
        <button class="btn btn-primary" onclick="addCustomCompound()">+ ì¶”ê°€</button>
        <button class="btn btn-secondary" onclick="clearCustom()">Custom ì´ˆê¸°í™”</button>
      </div>
      <div>
        <span style="font-size:.8rem;color:var(--text-muted);font-weight:600;">ë¹ ë¥¸ ì˜ˆì‹œ:</span>
        <div class="preset-chips">
          <button class="chip chip-ulva"      onclick="fillPreset('Caffeic acid','OC(=O)/C=C/c1ccc(O)c(O)c1','ulva')">ğŸŒ¿ Caffeic acid</button>
          <button class="chip chip-ulva"      onclick="fillPreset('Chlorophyll-a derivative','CN1C2=CC3=C(C=C3/C=C4/C(=C)C(CCC(=O)OCC=C(CCC/C(=C/CCC/C(=C/CCC=C(C)C)C)C)C)=[N+]4[Mg--]14)[C@@H](C(=O)OC)[C@@]2(C)CC(=O)OC','ulva')">ğŸŒ¿ Chlorophyll</button>
          <button class="chip chip-sargassum" onclick="fillPreset('Squalene','CC(=CCC/C(=C/CCC(=CCC/C(=C/CCC=C(C)C)C)C)C)C','sargassum')">ğŸŸ¤ Squalene</button>
          <button class="chip chip-sargassum" onclick="fillPreset('Fucosterol','[C@@H]1([C@H](CC[C@@H]2[C@@]1(CC[C@@H]1[C@H]2CC=C2C[C@@H](O)CC[C@]12C)C)/C=C/[C@@H](CC)CC)C','sargassum')">ğŸŸ¤ Fucosterol</button>
          <button class="chip chip-gelidium"  onclick="fillPreset('Kaempferol','O=c1c(O)c(-c2ccc(O)cc2)oc2cc(O)cc(O)c12','gelidium')">ğŸ”´ Kaempferol</button>
          <button class="chip chip-gelidium"  onclick="fillPreset('Agarose monomer','O[C@@H]1[C@H](OC[C@H]2O[C@@H](O)[C@H](O)[C@H](O)[C@H]2O)O[C@H](CO)[C@H]1O','gelidium')">ğŸ”´ Agarose</button>
          <button class="chip chip-all"       onclick="loadAllPresets()">âš¡ ì „ì²´ ì˜ˆì‹œ ë¡œë“œ</button>
        </div>
      </div>
    </div>
  </section>

  <!-- â”€â”€â”€ Gallery â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <section>
    <div class="section-title">ğŸ”¬ í™”í•©ë¬¼ êµ¬ì¡° ê°¤ëŸ¬ë¦¬</div>

    <div class="filter-bar">
      <button class="filter-btn filter-all active"       data-filter="all"       onclick="setFilter('all',this)">ì „ì²´</button>
      <button class="filter-btn filter-ulva"             data-filter="ulva"      onclick="setFilter('ulva',this)">ğŸŒ¿ Ulva</button>
      <button class="filter-btn filter-sargassum"        data-filter="sargassum" onclick="setFilter('sargassum',this)">ğŸŸ¤ Sargassum</button>
      <button class="filter-btn filter-gelidium"         data-filter="gelidium"  onclick="setFilter('gelidium',this)">ğŸ”´ Gelidium</button>
      <button class="filter-btn filter-custom"           data-filter="custom"    onclick="setFilter('custom',this)">âœï¸ Custom</button>
      <span id="result-count"></span>
    </div>

    <div id="compound-grid" class="compound-grid"></div>
    <div id="empty-state" class="empty-state" style="display:none">
      <span>ğŸ”</span>í•´ë‹¹ ì¡°ê±´ì˜ í™”í•©ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.
    </div>
  </section>

</main>

<!-- â”€â”€â”€ Detail Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div id="modal-overlay" class="modal-overlay" onclick="handleOverlayClick(event)">
  <div class="modal">
    <div class="modal-header">
      <h2 id="modal-title"></h2>
      <button class="modal-close" onclick="closeModal()">âœ•</button>
    </div>
    <div class="modal-canvas-wrap">
      <canvas id="modal-canvas" width="480" height="300"></canvas>
    </div>
    <div class="modal-body">
      <div class="modal-field">
        <span class="field-label">Species</span>
        <span class="field-value" id="modal-species"></span>
      </div>
      <div class="modal-field">
        <span class="field-label">Targets</span>
        <span class="field-value" id="modal-targets"></span>
      </div>
      <div class="modal-field full">
        <span class="field-label">SMILES</span>
        <div class="field-value mono" id="modal-smiles"></div>
      </div>
      <div class="modal-field full">
        <span class="field-label">Description</span>
        <span class="field-value" id="modal-desc"></span>
      </div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-primary" onclick="downloadCanvas()">â¬‡ PNG ì €ì¥</button>
      <button class="btn btn-secondary" onclick="copySmiles()">ğŸ“‹ SMILES ë³µì‚¬</button>
    </div>
  </div>
</div>

<footer>
  Marine Natural Product Discovery Pipeline Â· í•´ì–‘ ì²œì—°ë¬¼ ì‹ ì•½ íƒìƒ‰ Â· Rendering: SmilesDrawer 2.0
</footer>

<script>
/* â”€â”€â”€ Compound Database â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const DB = [
  // Ulva (Sea Lettuce) â€” Green Algae
  {
    id: 'u1',
    name: 'Caffeic Acid',
    species: 'ulva',
    smiles: 'OC(=O)/C=C/c1ccc(O)c(O)c1',
    targets: ['FASN', 'PPARG'],
    desc: 'ìš¸ë°”ì—ì„œ ë¶„ë¦¬ëœ í˜ë†€ì‚°. FASN ì–µì œ ë° í•­ì‚°í™” í™œì„±ì„ í†µí•´ ì§€ì§ˆ ëŒ€ì‚¬ë¥¼ ì¡°ì ˆí•œë‹¤.'
  },
  {
    id: 'u2',
    name: 'Quercetin',
    species: 'ulva',
    smiles: 'O=c1c(O)c(-c2ccc(O)c(O)c2)oc2cc(O)cc(O)c12',
    targets: ['PPARG', 'AKT1', 'mTOR'],
    desc: 'PPARG í™œì„±í™” ë° AKT1 ê²½ë¡œ ì¡°ì ˆì„ í†µí•´ ê·¼ìœ¡ ë‹¨ë°±ì§ˆ í•©ì„±ì— ê´€ì—¬í•˜ëŠ” í”Œë¼ë³´ë…¸ì´ë“œ.'
  },
  {
    id: 'u3',
    name: 'Rutin',
    species: 'ulva',
    smiles: 'O=c1c(OC2OC(CO[C@@H]3O[C@@H](C)[C@H](O)[C@@H](O)[C@H]3O)[C@@H](O)[C@H](O)[C@H]2O)c(-c2ccc(O)c(O)c2)oc2cc(O)cc(O)c12',
    targets: ['AMPK', 'mTOR'],
    desc: 'AMPK í™œì„±í™”ë¥¼ í†µí•´ ì—ë„ˆì§€ í•­ìƒì„±ì„ ìœ ì§€í•˜ê³  ê·¼ê°ì†Œì¦ ì˜ˆë°©ì— ê¸°ì—¬í•œë‹¤.'
  },
  {
    id: 'u4',
    name: 'Ulvic Acid (Glucuronic Acid)',
    species: 'ulva',
    smiles: 'OC(=O)[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O',
    targets: ['AMPK'],
    desc: 'ìš¸ë°˜(Ulvan) ë‹¤ë‹¹ë¥˜ì˜ ë‹¨ëŸ‰ì²´ ì„±ë¶„. ëŒ€ì‚¬ ì¡°ì ˆ í™œì„±ì„ ë³´ì¸ë‹¤.'
  },
  {
    id: 'u5',
    name: 'L-Rhamnose',
    species: 'ulva',
    smiles: 'C[C@@H]1OC(O)[C@@H](O)[C@H](O)[C@@H]1O',
    targets: ['AMPK'],
    desc: 'ìš¸ë°˜ì˜ ì£¼ìš” ë‹¹ êµ¬ì„± ì„±ë¶„. í•­ì—¼ì¦ ë° AMPK ì¡°ì ˆ íš¨ê³¼ê°€ ë³´ê³ ë¨.'
  },
  // Sargassum (Brown Algae)
  {
    id: 's1',
    name: 'Fucoxanthin',
    species: 'sargassum',
    smiles: 'CC(=O)O[C@@H]1CC(=C)[C@@]2(C)CCC[C@@]2(C)/C=C/C(=C\\C=C\\C(C)=C\\C=C\\[C@H]3O[C@]4(C)CCCC(C)(C)[C@@H]4/C3=C\\C(=O)C1)/C',
    targets: ['AMPK', 'PPARG', 'FASN'],
    desc: 'ê°ˆì¡°ë¥˜ íŠ¹ìœ ì˜ ì¹´ë¡œí‹°ë…¸ì´ë“œ. AMPK í™œì„±í™” ë° FASN ì–µì œë¥¼ í†µí•´ ê°•ë ¥í•œ í•­ë¹„ë§ŒÂ·í•­ê·¼ê°ì†Œì¦ íš¨ê³¼ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.'
  },
  {
    id: 's2',
    name: 'Squalene',
    species: 'sargassum',
    smiles: 'CC(=CCC/C(=C/CCC(=CCC/C(=C/CCC=C(C)C)C)C)C)C',
    targets: ['FASN', 'mTOR'],
    desc: 'ì‚¼ì¤‘ í…Œë¥´íœê³„ ë¶ˆí¬í™” íƒ„í™”ìˆ˜ì†Œ. FASN ì–µì œ ë° ì„¸í¬ë§‰ ë³´í˜¸ íš¨ê³¼ë¥¼ í†µí•´ ëŒ€ì‚¬ ì§ˆí™˜ì„ ì¡°ì ˆí•œë‹¤.'
  },
  {
    id: 's3',
    name: 'Fucosterol',
    species: 'sargassum',
    smiles: '[C@@H]1([C@H](CC[C@@H]2[C@@]1(CC[C@@H]1[C@H]2CC=C2C[C@@H](O)CC[C@]12C)C)/C=C/CC)C',
    targets: ['AKT1', 'PPARG'],
    desc: 'ê°ˆì¡°ë¥˜ì˜ ì£¼ìš” ìŠ¤í…Œë¡¤. AKT1 ê²½ë¡œë¥¼ í†µí•œ ê·¼ìœ¡ ë‹¨ë°±ì§ˆ í•©ì„± ì´‰ì§„ ë° ë‹¹ë‡¨ ê°œì„  íš¨ê³¼.'
  },
  {
    id: 's4',
    name: 'EPA (Eicosapentaenoic Acid)',
    species: 'sargassum',
    smiles: 'CCCCC/C=C\\C/C=C\\C/C=C\\C/C=C\\C/C=C\\CCCC(=O)O',
    targets: ['AMPK', 'mTOR', 'PPARG'],
    desc: 'ì˜¤ë©”ê°€-3 ì§€ë°©ì‚°. AMPK í™œì„±í™” ë° mTOR ê²½ë¡œ ì¡°ì ˆì„ í†µí•´ ê·¼ê°ì†Œì¦ ì¹˜ë£Œì— í•µì‹¬ì  ì—­í• .'
  },
  {
    id: 's5',
    name: 'Myricetin',
    species: 'sargassum',
    smiles: 'O=c1c(O)c(-c2cc(O)c(O)c(O)c2)oc2cc(O)cc(O)c12',
    targets: ['FASN', 'AKT1'],
    desc: 'FASN ì§ì ‘ ì–µì œ í™œì„±ì„ ê°–ëŠ” í´ë¦¬í˜ë†€. ì§€ë°©ì‚° í•©ì„± ì°¨ë‹¨ì„ í†µí•´ ë¹„ë§ŒÂ·ê·¼ê°ì†Œì¦ ê°œì„ .'
  },
  {
    id: 's6',
    name: 'Eckol',
    species: 'sargassum',
    smiles: 'Oc1cc(O)c2c(c1)Oc1c(O)c(O)cc(c1)Oc1cc(O)c(O)cc1-2',
    targets: ['AKT1', 'mTOR'],
    desc: 'ê°ˆì¡°ë¥˜ í”Œë¡œë¡œíƒ„ë‹Œ ê³„ì—´. AKT1/mTOR ì‹ í˜¸ì „ë‹¬ ì–µì œë¥¼ í†µí•´ ì„¸í¬ ë³´í˜¸ ë° ê·¼ìœ¡ ì¬ìƒ ì´‰ì§„.'
  },
  // Gelidium (Red Algae)
  {
    id: 'g1',
    name: 'Kaempferol',
    species: 'gelidium',
    smiles: 'O=c1c(O)c(-c2ccc(O)cc2)oc2cc(O)cc(O)c12',
    targets: ['mTOR', 'AKT1'],
    desc: 'í™ì¡°ë¥˜ í”Œë¼ë³´ë…¸ì´ë“œ. mTOR ì–µì œë¥¼ í†µí•œ ìê°€í¬ì‹ ìœ ë„ ë° ê·¼ìœ¡ ë‹¨ë°±ì§ˆ í•­ìƒì„± ìœ ì§€.'
  },
  {
    id: 'g2',
    name: 'Agarose Monomer',
    species: 'gelidium',
    smiles: 'O[C@@H]1[C@H](OC[C@H]2O[C@@H](O)[C@H](O)[C@H](O)[C@H]2O)O[C@H](CO)[C@H]1O',
    targets: ['AMPK'],
    desc: 'ìš°ë­‡ê°€ì‚¬ë¦¬ í•œì²œì˜ ë°˜ë³µ ì´ë‹¹ë¥˜ ë‹¨ìœ„. í”„ë¦¬ë°”ì´ì˜¤í‹± íš¨ê³¼ë¥¼ í†µí•œ AMPK ê°„ì ‘ í™œì„±í™”.'
  },
  {
    id: 'g3',
    name: 'Carrageenan Monomer (Îº)',
    species: 'gelidium',
    smiles: 'OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1OS(=O)(=O)O',
    targets: ['AMPK', 'PPARG'],
    desc: 'Îº-ì¹´ë¼ê¸°ë‚œ êµ¬ì„± ë‹¨ìœ„. í•­ì—¼ì¦ íš¨ê³¼ ë° ì§€ì§ˆ ëŒ€ì‚¬ ì¡°ì ˆ í™œì„±.'
  },
  {
    id: 'g4',
    name: 'DHA (Docosahexaenoic Acid)',
    species: 'gelidium',
    smiles: 'CC/C=C\\C/C=C\\C/C=C\\C/C=C\\C/C=C\\C/C=C\\CCC(=O)O',
    targets: ['AMPK', 'mTOR', 'PPARG'],
    desc: 'ì˜¤ë©”ê°€-3 DHA. PPARG í™œì„±í™” ë° ê·¼ìœ¡ ì„¸í¬ ë‚´ ë‹¨ë°±ì§ˆ ë¶„í•´ ì–µì œë¡œ ê·¼ê°ì†Œì¦ ê°œì„  ê¸°ì—¬.'
  },
  {
    id: 'g5',
    name: 'R-Phycoerythrobilin',
    species: 'gelidium',
    smiles: 'CC1=C(CC2=C(CC3=C(C=C4NC(=O)C(=C4CC)CC)C(=C)N3)NC2=O)N=C1',
    targets: ['FASN'],
    desc: 'í™ì¡°ë¥˜ í”¼ì½”ë¹Œë¦° ìƒ‰ì†Œ. í•­ì‚°í™” ë° FASN ì¡°ì ˆì„ í†µí•œ ì§€ì§ˆ ëŒ€ì‚¬ ê°œì„  íš¨ê³¼.'
  }
];

/* â”€â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let compounds = [...DB];
let activeFilter = 'all';
let modalCompound = null;
let modalSd = null;

/* â”€â”€â”€ SmilesDrawer options â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const SD_OPTS_CARD   = { width: 200, height: 155, bondThickness: 1.0, fontSizeLarge: 6, fontSizeSmall: 4.5, compactDrawing: false };
const SD_OPTS_MODAL  = { width: 460, height: 290, bondThickness: 1.2, fontSizeLarge: 8, fontSizeSmall: 6,   compactDrawing: false };

const sdCard  = new SmilesDrawer.Drawer(SD_OPTS_CARD);
const sdModal = new SmilesDrawer.Drawer(SD_OPTS_MODAL);

/* â”€â”€â”€ Render helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderToCanvas(smiles, drawer, canvas, callback) {
  SmilesDrawer.parse(smiles, (tree) => {
    drawer.draw(tree, canvas, 'light', false);
    if (callback) callback(true);
  }, (err) => {
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = '#c0392b';
    ctx.font = '12px sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('âš  Invalid SMILES', canvas.width / 2, canvas.height / 2);
    if (callback) callback(false);
  });
}

/* â”€â”€â”€ Build card DOM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function buildCard(compound) {
  const card = document.createElement('div');
  card.className = 'compound-card';
  card.dataset.species = compound.species;
  card.dataset.id = compound.id;

  const canvasId = `cv-${compound.id}`;
  const targets = (compound.targets || []).map(t => `<span class="target-tag">${t}</span>`).join('');

  card.innerHTML = `
    <div class="card-canvas-wrap">
      <canvas id="${canvasId}" width="200" height="155"></canvas>
    </div>
    <div class="card-body">
      <div class="card-title" title="${compound.name}">${compound.name}</div>
      <span class="badge badge-${compound.species}">${speciesLabel(compound.species)}</span>
      <div class="card-smiles" title="${compound.smiles}">${compound.smiles}</div>
      <div class="card-targets">${targets}</div>
    </div>
  `;

  card.addEventListener('click', () => openModal(compound));
  return card;
}

function speciesLabel(s) {
  return { ulva: 'ğŸŒ¿ Ulva', sargassum: 'ğŸŸ¤ Sargassum', gelidium: 'ğŸ”´ Gelidium', custom: 'âœï¸ Custom' }[s] || s;
}

/* â”€â”€â”€ Render all cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderGrid() {
  const grid = document.getElementById('compound-grid');
  grid.innerHTML = '';

  const filtered = activeFilter === 'all'
    ? compounds
    : compounds.filter(c => c.species === activeFilter);

  document.getElementById('result-count').textContent = `${filtered.length}ê°œ í™”í•©ë¬¼`;

  if (filtered.length === 0) {
    document.getElementById('empty-state').style.display = '';
    return;
  }
  document.getElementById('empty-state').style.display = 'none';

  filtered.forEach(compound => {
    const card = buildCard(compound);
    grid.appendChild(card);
    // defer render so DOM is visible
    requestAnimationFrame(() => {
      const canvas = document.getElementById(`cv-${compound.id}`);
      if (canvas) renderToCanvas(compound.smiles, sdCard, canvas);
    });
  });
}

/* â”€â”€â”€ Filter â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function setFilter(filter, btn) {
  activeFilter = filter;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderGrid();
}

/* â”€â”€â”€ Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function openModal(compound) {
  modalCompound = compound;
  document.getElementById('modal-title').textContent    = compound.name;
  document.getElementById('modal-species').textContent  = speciesLabel(compound.species);
  document.getElementById('modal-smiles').textContent   = compound.smiles;
  document.getElementById('modal-targets').textContent  = (compound.targets || []).join(', ') || 'â€”';
  document.getElementById('modal-desc').textContent     = compound.desc || 'â€”';

  const canvas = document.getElementById('modal-canvas');
  canvas.width  = 460;
  canvas.height = 290;
  renderToCanvas(compound.smiles, sdModal, canvas);

  document.getElementById('modal-overlay').classList.add('open');
}

function closeModal() {
  document.getElementById('modal-overlay').classList.remove('open');
  modalCompound = null;
}

function handleOverlayClick(e) {
  if (e.target === document.getElementById('modal-overlay')) closeModal();
}

document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });

/* â”€â”€â”€ Download PNG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function downloadCanvas() {
  const canvas = document.getElementById('modal-canvas');
  const link = document.createElement('a');
  link.download = `${(modalCompound?.name || 'compound').replace(/\s+/g,'_')}.png`;
  link.href = canvas.toDataURL('image/png');
  link.click();
}

/* â”€â”€â”€ Copy SMILES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function copySmiles() {
  if (!modalCompound) return;
  navigator.clipboard.writeText(modalCompound.smiles).then(() => {
    const btn = document.querySelector('.modal-actions .btn-secondary');
    const orig = btn.textContent;
    btn.textContent = 'âœ… ë³µì‚¬ ì™„ë£Œ!';
    setTimeout(() => { btn.textContent = orig; }, 1500);
  });
}

/* â”€â”€â”€ Custom input â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function addCustomCompound() {
  const name   = document.getElementById('inp-name').value.trim();
  const smiles = document.getElementById('inp-smiles').value.trim();
  const species = document.getElementById('inp-species').value;

  if (!smiles) { alert('SMILESë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }

  const id = 'custom-' + Date.now();
  const compound = {
    id,
    name: name || 'Custom Compound',
    species,
    smiles,
    targets: [],
    desc: 'ì‚¬ìš©ì ì…ë ¥ í™”í•©ë¬¼.'
  };

  compounds.push(compound);
  document.getElementById('inp-name').value   = '';
  document.getElementById('inp-smiles').value = '';

  // Switch to show the right filter or all
  if (activeFilter !== 'all' && activeFilter !== species) {
    setFilter(species, document.querySelector(`[data-filter="${species}"]`) || document.querySelector('[data-filter="all"]'));
  } else {
    renderGrid();
  }
}

function clearCustom() {
  compounds = compounds.filter(c => !c.id.startsWith('custom-'));
  renderGrid();
}

/* â”€â”€â”€ Preset fill â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function fillPreset(name, smiles, species) {
  document.getElementById('inp-name').value   = name;
  document.getElementById('inp-smiles').value = smiles;
  document.getElementById('inp-species').value = species;
}

/* â”€â”€â”€ Load all presets as custom â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function loadAllPresets() {
  const extras = [
    { name: 'Apigenin',     smiles: 'O=c1cc(-c2ccc(O)cc2)oc2cc(O)cc(O)c12', species: 'ulva',      targets: ['FASN','mTOR'],   desc: 'í•­ì—¼Â·í•­ì§€ë°© í”Œë¼ë³´ë…¸ì´ë“œ' },
    { name: 'Beta-Carotene',smiles: 'CC1=C(/C=C/C(=C/C=C/C(=C/C=C/C=C(C)/C=C/C=C(C)/C=C/C2=C(C)CCCC2(C)C)C)C)CCCC1(C)C', species: 'sargassum', targets: ['PPARG'], desc: 'ê°ˆì¡°ë¥˜ ì¹´ë¡œí‹°ë…¸ì´ë“œ. í•­ì‚°í™” í™œì„±.' },
    { name: 'Iodine-rich polyphenol', smiles: 'Oc1cc(O)c2c(c1)Oc1cc(O)c(O)cc1-2', species: 'gelidium', targets: ['AKT1'], desc: 'í™ì¡°ë¥˜ í´ë¦¬í˜ë†€ ìœ ë„ì²´.' },
  ];
  extras.forEach(e => {
    const id = 'custom-' + Date.now() + Math.random();
    compounds.push({ id, ...e });
  });
  renderGrid();
}

/* â”€â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
renderGrid();
</script>
</body>
</html>
